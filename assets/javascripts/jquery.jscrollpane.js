/*!
 * jScrollPane - v2.0.0beta11 - 2011-04-21
 * http://jscrollpane.kelvinluck.com/
 *
 * Copyright (c) 2010 Kelvin Luck
 * Dual licensed under the MIT and GPL licenses.
 */
// Copyright (c) 2011 Kelvin Luck
!function(t,e,n){t.fn.jScrollPane=function(e){function i(e,i){function o(i){var r,c,p,u,d,j,g=!1,v=!1;G=i,q===n?(d=e.scrollTop(),j=e.scrollLeft(),e.css({overflow:"hidden",padding:0}),V=e.innerWidth()+bt,E=e.innerHeight(),e.width(V),q=t('<div class="jspPane" />').css("padding",mt).append(e.children()),O=t('<div class="jspContainer" />').css({width:V+"px",height:E+"px"}).append(q).appendTo(e)):(e.css("width",""),g=G.stickToBottom&&S(),v=G.stickToRight&&H(),u=e.innerWidth()+bt!=V||e.outerHeight()!=E,u&&(V=e.innerWidth()+bt,E=e.innerHeight(),O.css({width:V+"px",height:E+"px"})),wt=N,q.css("width",""),e.width(V),O.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()),q.css("overflow","auto"),N=i.contentWidth?i.contentWidth:q[0].scrollWidth,K=q[0].scrollHeight,q.css("overflow",""),Q=N/V,U=K/E,$=U>1,J=Q>1,J||$?(e.addClass("jspScrollable"),r=G.maintainPosition&&(tt||it),r&&(c=B(),p=D()),s(),a(),l(),r&&(C(v?N-V:c,!1),y(g?K-E:p,!1)),W(),P(),L(),G.enableKeyboardNavigation&&Y(),G.clickOnTrack&&f(),R(),G.hijackInternalLinks&&I()):(e.removeClass("jspScrollable"),q.css({top:0,width:O.width()-bt}),A(),M(),X(),h(),z()),G.autoReinitialise&&!vt?vt=setInterval(function(){o(G)},G.autoReinitialiseDelay):!G.autoReinitialise&&vt&&clearInterval(vt),d&&e.scrollTop(0)&&y(d,!1),j&&e.scrollLeft(0)&&C(j,!1),e.trigger("jsp-initialised",[J||$])}function s(){$&&(O.append(t('<div class="jspVerticalBar" />').append(t('<div class="jspCap jspCapTop" />'),t('<div class="jspTrack" />').append(t('<div class="jspDrag" />').append(t('<div class="jspDragTop" />'),t('<div class="jspDragBottom" />'))),t('<div class="jspCap jspCapBottom" />'))),ot=O.find(">.jspVerticalBar"),st=ot.find(">.jspTrack"),Z=st.find(">.jspDrag"),G.showArrows&&(lt=t('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",u(0,-1)).bind("click.jsp",x),pt=t('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",u(0,1)).bind("click.jsp",x),G.arrowScrollOnHover&&(lt.bind("mouseover.jsp",u(0,-1,lt)),pt.bind("mouseover.jsp",u(0,1,pt))),p(st,G.verticalArrowPositions,lt,pt)),at=E,O.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){at-=t(this).outerHeight()}),Z.hover(function(){Z.addClass("jspHover")},function(){Z.removeClass("jspHover")}).bind("mousedown.jsp",function(e){t("html").bind("dragstart.jsp selectstart.jsp",x),Z.addClass("jspActive");var n=e.pageY-Z.position().top;return t("html").bind("mousemove.jsp",function(t){g(t.pageY-n,!1)}).bind("mouseup.jsp mouseleave.jsp",j),!1}),r())}function r(){st.height(at+"px"),tt=0,rt=G.verticalGutter+st.outerWidth(),q.width(V-rt-bt);try{0===ot.position().left&&q.css("margin-left",rt+"px")}catch(t){}}function a(){J&&(O.append(t('<div class="jspHorizontalBar" />').append(t('<div class="jspCap jspCapLeft" />'),t('<div class="jspTrack" />').append(t('<div class="jspDrag" />').append(t('<div class="jspDragLeft" />'),t('<div class="jspDragRight" />'))),t('<div class="jspCap jspCapRight" />'))),ut=O.find(">.jspHorizontalBar"),dt=ut.find(">.jspTrack"),et=dt.find(">.jspDrag"),G.showArrows&&(jt=t('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",u(-1,0)).bind("click.jsp",x),gt=t('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",u(1,0)).bind("click.jsp",x),G.arrowScrollOnHover&&(jt.bind("mouseover.jsp",u(-1,0,jt)),gt.bind("mouseover.jsp",u(1,0,gt))),p(dt,G.horizontalArrowPositions,jt,gt)),et.hover(function(){et.addClass("jspHover")},function(){et.removeClass("jspHover")}).bind("mousedown.jsp",function(e){t("html").bind("dragstart.jsp selectstart.jsp",x),et.addClass("jspActive");var n=e.pageX-et.position().left;return t("html").bind("mousemove.jsp",function(t){m(t.pageX-n,!1)}).bind("mouseup.jsp mouseleave.jsp",j),!1}),ft=O.innerWidth(),c())}function c(){O.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){ft-=t(this).outerWidth()}),dt.width(ft+"px"),it=0}function l(){if(J&&$){var e=dt.outerHeight(),n=st.outerWidth();at-=e,t(ut).find(">.jspCap:visible,>.jspArrow").each(function(){ft+=t(this).outerWidth()}),ft-=n,E-=n,V-=e,dt.parent().append(t('<div class="jspCorner" />').css("width",e+"px")),r(),c()}J&&q.width(O.outerWidth()-bt+"px"),K=q.outerHeight(),U=K/E,J&&(ht=Math.ceil(1/Q*ft),ht>G.horizontalDragMaxWidth?ht=G.horizontalDragMaxWidth:ht<G.horizontalDragMinWidth&&(ht=G.horizontalDragMinWidth),et.width(ht+"px"),nt=ft-ht,b(it)),$&&(ct=Math.ceil(1/U*at),ct>G.verticalDragMaxHeight?ct=G.verticalDragMaxHeight:ct<G.verticalDragMinHeight&&(ct=G.verticalDragMinHeight),Z.height(ct+"px"),_=at-ct,v(tt))}function p(t,e,n,i){var o,s="before",r="after";"os"==e&&(e=/Mac/.test(navigator.platform)?"after":"split"),e==s?r=e:e==r&&(s=e,o=n,n=i,i=o),t[s](n)[r](i)}function u(t,e,n){return function(){return d(t,e,this,n),this.blur(),!1}}function d(e,n,i,o){i=t(i).addClass("jspActive");var s,r,a=!0,c=function(){0!==e&&kt.scrollByX(e*G.arrowButtonSpeed),0!==n&&kt.scrollByY(n*G.arrowButtonSpeed),r=setTimeout(c,a?G.initialDelay:G.arrowRepeatFreq),a=!1};c(),s=o?"mouseout.jsp":"mouseup.jsp",o=o||t("html"),o.bind(s,function(){i.removeClass("jspActive"),r&&clearTimeout(r),r=null,o.unbind(s)})}function f(){h(),$&&st.bind("mousedown.jsp",function(e){if(e.originalTarget===n||e.originalTarget==e.currentTarget){var i,o=t(this),s=o.offset(),r=e.pageY-s.top-tt,a=!0,c=function(){var t=o.offset(),n=e.pageY-t.top-ct/2,s=E*G.scrollPagePercent,p=_*s/(K-E);if(r<0)tt-p>n?kt.scrollByY(-s):g(n);else{if(!(r>0))return void l();tt+p<n?kt.scrollByY(s):g(n)}i=setTimeout(c,a?G.initialDelay:G.trackClickRepeatFreq),a=!1},l=function(){i&&clearTimeout(i),i=null,t(document).unbind("mouseup.jsp",l)};return c(),t(document).bind("mouseup.jsp",l),!1}}),J&&dt.bind("mousedown.jsp",function(e){if(e.originalTarget===n||e.originalTarget==e.currentTarget){var i,o=t(this),s=o.offset(),r=e.pageX-s.left-it,a=!0,c=function(){var t=o.offset(),n=e.pageX-t.left-ht/2,s=V*G.scrollPagePercent,p=nt*s/(N-V);if(r<0)it-p>n?kt.scrollByX(-s):m(n);else{if(!(r>0))return void l();it+p<n?kt.scrollByX(s):m(n)}i=setTimeout(c,a?G.initialDelay:G.trackClickRepeatFreq),a=!1},l=function(){i&&clearTimeout(i),i=null,t(document).unbind("mouseup.jsp",l)};return c(),t(document).bind("mouseup.jsp",l),!1}})}function h(){dt&&dt.unbind("mousedown.jsp"),st&&st.unbind("mousedown.jsp")}function j(){t("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp"),Z&&Z.removeClass("jspActive"),et&&et.removeClass("jspActive")}function g(t,e){$&&(t<0?t=0:t>_&&(t=_),e===n&&(e=G.animateScroll),e?kt.animate(Z,"top",t,v):(Z.css("top",t),v(t)))}function v(t){t===n&&(t=Z.position().top),O.scrollTop(0),tt=t;var i=0===tt,o=tt==_,s=t/_,r=-s*(K-E);yt==i&&Tt==o||(yt=i,Tt=o,e.trigger("jsp-arrow-change",[yt,Tt,Ct,Bt])),w(i,o),q.css("top",r),e.trigger("jsp-scroll-y",[-r,i,o]).trigger("scroll")}function m(t,e){J&&(t<0?t=0:t>nt&&(t=nt),e===n&&(e=G.animateScroll),e?kt.animate(et,"left",t,b):(et.css("left",t),b(t)))}function b(t){t===n&&(t=et.position().left),O.scrollTop(0),it=t;var i=0===it,o=it==nt,s=t/nt,r=-s*(N-V);Ct==i&&Bt==o||(Ct=i,Bt=o,e.trigger("jsp-arrow-change",[yt,Tt,Ct,Bt])),k(i,o),q.css("left",r),e.trigger("jsp-scroll-x",[-r,i,o]).trigger("scroll")}function w(t,e){G.showArrows&&(lt[t?"addClass":"removeClass"]("jspDisabled"),pt[e?"addClass":"removeClass"]("jspDisabled"))}function k(t,e){G.showArrows&&(jt[t?"addClass":"removeClass"]("jspDisabled"),gt[e?"addClass":"removeClass"]("jspDisabled"))}function y(t,e){g(t/(K-E)*_,e)}function C(t,e){m(t/(N-V)*nt,e)}function T(e,n,i){var o,s,r,a,c,l,p,u,d,f=0,h=0;try{o=t(e)}catch(t){return}for(s=o.outerHeight(),r=o.outerWidth(),O.scrollTop(0),O.scrollLeft(0);!o.is(".jspPane");)if(f+=o.position().top,h+=o.position().left,o=o.offsetParent(),/^body|html$/i.test(o[0].nodeName))return;a=D(),l=a+E,f<a||n?u=f-G.verticalGutter:f+s>l&&(u=f-E+s+G.verticalGutter),u&&y(u,i),c=B(),p=c+V,h<c||n?d=h-G.horizontalGutter:h+r>p&&(d=h-V+r+G.horizontalGutter),d&&C(d,i)}function B(){return-q.position().left}function D(){return-q.position().top}function S(){var t=K-E;return t>20&&t-D()<10}function H(){var t=N-V;return t>20&&t-B()<10}function P(){O.unbind(St).bind(St,function(t,e,n,i){var o=it,s=tt;return kt.scrollBy(n*G.mouseWheelSpeed,-i*G.mouseWheelSpeed,!1),o==it&&s==tt})}function A(){O.unbind(St)}function x(){return!1}function W(){q.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(t){T(t.target,!1)})}function M(){q.find(":input,a").unbind("focus.jsp")}function Y(){function n(){var t=it,e=tt;switch(i){case 40:kt.scrollByY(G.keyboardSpeed,!1);break;case 38:kt.scrollByY(-G.keyboardSpeed,!1);break;case 34:case 32:kt.scrollByY(E*G.scrollPagePercent,!1);break;case 33:kt.scrollByY(-E*G.scrollPagePercent,!1);break;case 39:kt.scrollByX(G.keyboardSpeed,!1);break;case 37:kt.scrollByX(-G.keyboardSpeed,!1)}return o=t!=it||e!=tt}var i,o,s=[];J&&s.push(ut[0]),$&&s.push(ot[0]),q.focus(function(){e.focus()}),e.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(e){if(e.target===this||s.length&&t(e.target).closest(s).length){var r=it,a=tt;switch(e.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:i=e.keyCode,n();break;case 35:y(K-E),i=null;break;case 36:y(0),i=null}return!(o=e.keyCode==i&&r!=it||a!=tt)}}).bind("keypress.jsp",function(t){return t.keyCode==i&&n(),!o}),G.hideFocus?(e.css("outline","none"),"hideFocus"in O[0]&&e.attr("hideFocus",!0)):(e.css("outline",""),"hideFocus"in O[0]&&e.attr("hideFocus",!1))}function X(){e.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp")}function R(){if(location.hash&&location.hash.length>1){var e,n;try{e=t(location.hash)}catch(t){return}e.length&&q.find(location.hash)&&(0===O.scrollTop()?n=setInterval(function(){O.scrollTop()>0&&(T(location.hash,!0),t(document).scrollTop(O.position().top),clearInterval(n))},50):(T(location.hash,!0),t(document).scrollTop(O.position().top)))}}function z(){t("a.jspHijack").unbind("click.jsp-hijack").removeClass("jspHijack")}function I(){z(),t("a[href^=#]").addClass("jspHijack").bind("click.jsp-hijack",function(){var t,e=this.href.split("#");if(e.length>1&&(t=e[1],t.length>0&&q.find("#"+t).length>0))return T("#"+t,!0),!1})}function L(){var t,e,n,i,o,s=!1;O.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(r){var a=r.originalEvent.touches[0];t=B(),e=D(),n=a.pageX,i=a.pageY,o=!1,s=!0}).bind("touchmove.jsp",function(r){if(s){var a=r.originalEvent.touches[0],c=it,l=tt;return kt.scrollTo(t+n-a.pageX,e+i-a.pageY),o=o||Math.abs(n-a.pageX)>5||Math.abs(i-a.pageY)>5,c==it&&l==tt}}).bind("touchend.jsp",function(){s=!1}).bind("click.jsp-touchclick",function(){if(o)return o=!1,!1})}function F(){var t=D(),n=B();e.removeClass("jspScrollable").unbind(".jsp"),e.replaceWith(Dt.append(q.children())),Dt.scrollTop(t),Dt.scrollLeft(n)}var G,q,V,E,O,N,K,Q,U,$,J,Z,_,tt,et,nt,it,ot,st,rt,at,ct,lt,pt,ut,dt,ft,ht,jt,gt,vt,mt,bt,wt,kt=this,yt=!0,Ct=!0,Tt=!1,Bt=!1,Dt=e.clone(!1,!1).empty(),St=t.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";mt=e.css("paddingTop")+" "+e.css("paddingRight")+" "+e.css("paddingBottom")+" "+e.css("paddingLeft"),bt=(parseInt(e.css("paddingLeft"),10)||0)+(parseInt(e.css("paddingRight"),10)||0),t.extend(kt,{reinitialise:function(e){e=t.extend({},G,e),o(e)},scrollToElement:function(t,e,n){T(t,e,n)},scrollTo:function(t,e,n){C(t,n),y(e,n)},scrollToX:function(t,e){C(t,e)},scrollToY:function(t,e){y(t,e)},scrollToPercentX:function(t,e){C(t*(N-V),e)},scrollToPercentY:function(t,e){y(t*(K-E),e)},scrollBy:function(t,e,n){kt.scrollByX(t,n),kt.scrollByY(e,n)},scrollByX:function(t,e){t=t>=0?Math.max(t,1):Math.min(t,-1),m((B()+t)/(N-V)*nt,e)},scrollByY:function(t,e){t=t>=0?Math.max(t,1):Math.min(t,-1),g((D()+t)/(K-E)*_,e)},positionDragX:function(t,e){m(t,e)},positionDragY:function(t,e){g(t,e)},animate:function(t,e,n,i){var o={};o[e]=n,t.animate(o,{duration:G.animateDuration,ease:G.animateEase,queue:!1,step:i})},getContentPositionX:function(){return B()},getContentPositionY:function(){return D()},getContentWidth:function(){return N},getContentHeight:function(){return K},getPercentScrolledX:function(){return B()/(N-V)},getPercentScrolledY:function(){return D()/(K-E)},getIsScrollableH:function(){return J},getIsScrollableV:function(){return $},getContentPane:function(){return q},scrollToBottom:function(t){g(_,t)},hijackInternalLinks:function(){I()},destroy:function(){F()}}),o(i)}e=t.extend({},t.fn.jScrollPane.defaults,e),t.each(["mouseWheelSpeed","arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){e[this]=e[this]||e.speed});var o;return this.each(function(){var n=t(this),s=n.data("jsp");s?s.reinitialise(e):(s=new i(n,e),n.data("jsp",s)),o=o?o.add(n):n}),o},t.fn.jScrollPane.defaults={showArrows:!1,maintainPosition:!0,stickToBottom:!1,stickToRight:!1,clickOnTrack:!0,autoReinitialise:!1,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:n,animateScroll:!1,animateDuration:300,animateEase:"linear",hijackInternalLinks:!1,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:0,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:!1,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:!0,hideFocus:!1,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:.8}}(jQuery);